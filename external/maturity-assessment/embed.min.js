(function(u){"use strict";const o=new Map,p=function(){const s=document.getElementsByTagName("script");for(let e=s.length-1;e>=0;e--){const t=s[e].src;if(t)try{const n=new URL(t),r=n.pathname;if(r.endsWith("/embed.min.js")||r.endsWith("/embed.js"))return n.origin+r.replace(/\/embed(\.min)?\.js$/,"")}catch{continue}}return""}();function y(s){const{element:e,type:t,version:n,options:r}=s;if(!e)return console.error("[RedwoodAssessment] No element provided"),null;const a=o.get(e);a&&(a.remove(),o.delete(e));const l=(r==null?void 0:r.baseUrl)||p,d=n?`v${n}`:"latest";let h=`${l}/${d}/index-embed.html`;const c=new URLSearchParams;c.set("type",t),c.set("embed","true"),r!=null&&r.sessionId&&c.set("session",r.sessionId),h+=`?${c.toString()}`;const i=document.createElement("iframe");return i.src=h,i.style.cssText=`
    width: 100%;
    min-height: 600px;
    border: none;
    display: block;
    overflow: hidden;
  `,i.setAttribute("allowfullscreen","true"),i.setAttribute("allow","clipboard-write"),o.set(e,i),e.innerHTML="",e.appendChild(i),i}function f(s,e,t){var r,a,l;const n=s.data;if(!(!n||typeof n.type!="string")&&n.type.startsWith("redwood:assessment:"))switch(n.type){case"redwood:assessment:ready":(r=e.onReady)==null||r.call(e);break;case"redwood:assessment:complete":(a=e.onComplete)==null||a.call(e,n.payload);break;case"redwood:assessment:resize":{const{height:d}=n.payload;d&&d>0&&(t.style.height=`${d}px`,(l=e.onResize)==null||l.call(e,d));break}}}function m(s){if(!s.element){console.error("[RedwoodAssessment] Element not found");return}const e=y(s);if(!e)return;const t=r=>{r.source===e.contentWindow&&f(r,s,e)};window.addEventListener("message",t);const n=new MutationObserver(()=>{document.contains(e)||(window.removeEventListener("message",t),n.disconnect(),s.element&&o.get(s.element)===e&&o.delete(s.element))});n.observe(document.body,{childList:!0,subtree:!0})}function b(s){for(const e of s)typeof e=="function"?e():m(e)}function w(){const s=window.RedwoodAssessment,e={push(t){typeof t=="function"?t():document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>m(t)):m(t)},init(t){this.push(t)},destroy(t){const n=o.get(t);n&&(n.remove(),o.delete(t))},version:"1.0.0"};window.RedwoodAssessment=e,Array.isArray(s)&&b(s)}typeof window<"u"&&w(),u.init=w,u.initAssessment=m,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})(this.RedwoodAssessment=this.RedwoodAssessment||{});
//# sourceMappingURL=embed.min.js.map
